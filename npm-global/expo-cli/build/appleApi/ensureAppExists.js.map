{"version":3,"sources":["../../src/appleApi/ensureAppExists.ts"],"names":["ensureAppExists","appleCtx","accountName","projectName","bundleIdentifier","options","appleId","appleIdPassword","team","spinner","start","created","travelingFastlane","enablePushNotifications","id","succeed","err","fail"],"mappings":";;;;;;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAGA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;;;AAMO,eAAeA,eAAf,CACLC,QADK,EAEL;AACEC,EAAAA,WADF;AAEEC,EAAAA,WAFF;AAGEC,EAAAA;AAHF,CAFK,EAOLC,OAAgB,GAAG,EAPd,EAQL;AACA,QAAM;AAAEC,IAAAA,OAAF;AAAWC,IAAAA,eAAX;AAA4BC,IAAAA;AAA5B,MAAqCP,QAA3C;AACA,QAAMQ,OAAO,GAAG,oBAAK,qDAAL,EAA2DC,KAA3D,EAAhB;;AACA,MAAI;AACF,UAAM;AAAEC,MAAAA;AAAF,QAAc,MAAM,2BAAUC,8BAAkBZ,eAA5B,EAA6C,CACrE,IAAIK,OAAO,CAACQ,uBAAR,GAAkC,CAAC,sBAAD,CAAlC,GAA6D,EAAjE,CADqE,EAErEP,OAFqE,EAGrEC,eAHqE,EAIrEC,IAAI,CAACM,EAJgE,EAKrEV,gBALqE,EAMpE,IAAGF,WAAY,IAAGC,WAAY,EANsC,CAA7C,CAA1B;;AAQA,QAAIQ,OAAJ,EAAa;AACXF,MAAAA,OAAO,CAACM,OAAR,CAAiB,yCAAwCX,gBAAiB,GAA1E;AACD,KAFD,MAEO;AACLK,MAAAA,OAAO,CAACM,OAAR,CAAgB,yCAAhB;AACD;AACF,GAdD,CAcE,OAAOC,GAAP,EAAY;AACZP,IAAAA,OAAO,CAACQ,IAAR,CACE,qFADF;AAGA,UAAMD,GAAN;AACD;AACF","sourcesContent":["import ora from 'ora';\n\nimport { AppleCtx } from './authenticate';\nimport { runAction, travelingFastlane } from './fastlane';\n\ntype Options = {\n  enablePushNotifications?: boolean;\n};\n\nexport async function ensureAppExists(\n  appleCtx: AppleCtx,\n  {\n    accountName,\n    projectName,\n    bundleIdentifier,\n  }: { accountName: string; projectName: string; bundleIdentifier: string },\n  options: Options = {}\n) {\n  const { appleId, appleIdPassword, team } = appleCtx;\n  const spinner = ora(`Ensuring App ID exists on Apple Developer Portal...`).start();\n  try {\n    const { created } = await runAction(travelingFastlane.ensureAppExists, [\n      ...(options.enablePushNotifications ? ['--push-notifications'] : []),\n      appleId,\n      appleIdPassword,\n      team.id,\n      bundleIdentifier,\n      `@${accountName}/${projectName}`,\n    ]);\n    if (created) {\n      spinner.succeed(`App ID created with bundle identifier ${bundleIdentifier}.`);\n    } else {\n      spinner.succeed('App ID found on Apple Developer Portal.');\n    }\n  } catch (err) {\n    spinner.fail(\n      'Something went wrong when trying to ensure App ID exists on Apple Developer Portal!'\n    );\n    throw err;\n  }\n}\n"],"file":"ensureAppExists.js"}