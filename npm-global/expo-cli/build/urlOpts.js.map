{"version":3,"sources":["../src/urlOpts.ts"],"names":["addOptions","program","option","optsAsync","projectDir","options","opts","ProjectSettings","readAsync","host","lan","localhost","tunnel","filter","i","length","CommandError","hostType","offline","ConnectionStatus","setIsOffline","setAsync","printQRCode","url","qrcodeTerminal","generate","code","handleMobileOptsAsync","projectRoot","Promise","all","android","webOnly","Android","openWebProjectAsync","openProjectAsync","ios","Simulator","shouldPrompt","web","Webpack","openAsync"],"mappings":"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","sourcesContent":["import { Android, ConnectionStatus, ProjectSettings, Simulator, Webpack } from '@expo/xdl';\nimport { Command } from 'commander';\nimport indentString from 'indent-string';\nimport qrcodeTerminal from 'qrcode-terminal';\n\nimport CommandError from './CommandError';\nimport log from './log';\n\nexport type URLOptions = {\n  android?: boolean;\n  ios?: boolean;\n  web?: boolean;\n  host?: 'lan' | 'tunnel' | 'localhost';\n  tunnel?: boolean;\n  lan?: boolean;\n  localhost?: boolean;\n};\n\nfunction addOptions(program: Command) {\n  program\n    .option('-a, --android', 'Opens your app in Expo client on a connected Android device')\n    .option(\n      '-i, --ios',\n      'Opens your app in Expo client in a currently running iOS simulator on your computer'\n    )\n    .option('-w, --web', 'Opens your app in a web browser')\n    .option(\n      '-m, --host [mode]',\n      'lan (default), tunnel, localhost. Type of host to use. \"tunnel\" allows you to view your link on other networks'\n    )\n    .option('--tunnel', 'Same as --host tunnel')\n    .option('--lan', 'Same as --host lan')\n    .option('--localhost', 'Same as --host localhost');\n}\n\nasync function optsAsync(projectDir: string, options: any) {\n  var opts = await ProjectSettings.readAsync(projectDir);\n\n  if ([options.host, options.lan, options.localhost, options.tunnel].filter(i => i).length > 1) {\n    throw new CommandError(\n      'BAD_ARGS',\n      'Specify at most one of --host, --tunnel, --lan, and --localhost'\n    );\n  }\n\n  opts.hostType = 'lan';\n\n  if (options.offline) {\n    // TODO: maybe let people know that we will force localhost with offline?\n    ConnectionStatus.setIsOffline(true);\n    opts.hostType = 'localhost';\n  }\n\n  if (options.host) {\n    opts.hostType = options.host;\n  } else if (options.tunnel) {\n    opts.hostType = 'tunnel';\n  } else if (options.lan) {\n    opts.hostType = 'lan';\n  } else if (options.localhost) {\n    opts.hostType = 'localhost';\n  }\n\n  await ProjectSettings.setAsync(projectDir, opts);\n\n  return opts;\n}\n\nfunction printQRCode(url: string) {\n  qrcodeTerminal.generate(url, code => log(`${indentString(code, 2)}\\n`));\n}\n\nasync function handleMobileOptsAsync(\n  projectRoot: string,\n  options: Pick<URLOptions, 'ios' | 'android' | 'web'> & { webOnly?: boolean }\n) {\n  await Promise.all([\n    (async () => {\n      if (options.android) {\n        if (options.webOnly) {\n          await Android.openWebProjectAsync({ projectRoot });\n        } else {\n          await Android.openProjectAsync({ projectRoot });\n        }\n      }\n    })(),\n    (async () => {\n      if (options.ios) {\n        if (options.webOnly) {\n          await Simulator.openWebProjectAsync({ projectRoot, shouldPrompt: false });\n        } else {\n          await Simulator.openProjectAsync({ projectRoot, shouldPrompt: false });\n        }\n      }\n    })(),\n    (async () => {\n      if (options.web) {\n        await Webpack.openAsync(projectRoot);\n      }\n    })(),\n  ]);\n\n  return !!options.android || !!options.ios;\n}\n\nexport default {\n  addOptions,\n  handleMobileOptsAsync,\n  printQRCode,\n  optsAsync,\n};\n"],"file":"urlOpts.js"}