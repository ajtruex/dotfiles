{"version":3,"sources":["../../../src/credentials/api/IosApiV2Wrapper.ts"],"names":["ApiClient","constructor","api","getAllCredentialsApi","accountName","getAsync","owner","getAllCredentialsForAppApi","projectName","bundleIdentifier","getUserCredentialsByIdApi","id","createDistCertApi","credentials","postAsync","updateDistCertApi","putAsync","deleteDistCertApi","deleteAsync","useDistCertApi","userCredentialsId","experienceName","createPushKeyApi","updatePushKeyApi","deletePushKeyApi","usePushKeyApi","deletePushCertApi","updateProvisioningProfileApi","deleteProvisioningProfileApi"],"mappings":"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","sourcesContent":["import { ApiV2 } from '@expo/xdl';\n\nimport * as appleApi from '../../appleApi';\nimport { IosAppCredentials, IosDistCredentials, IosPushCredentials } from '../credentials';\n\nexport interface AppLookupParams {\n  accountName: string;\n  projectName: string;\n  bundleIdentifier: string;\n}\n\ninterface IosAllCredentialsForApp extends IosAppCredentials {\n  pushCredentials: Omit<IosPushCredentials, 'id' | 'type'>;\n  distCredentials: Omit<IosDistCredentials, 'id' | 'type'>;\n}\n\ninterface AllCredentialsApiResponse {\n  appCredentials: IosAppCredentials[];\n  userCredentials: (IosDistCredentials | IosPushCredentials)[];\n}\n\n// This class should not be used directly, use only as part of cached api client from ./IosApi.ts\n// or mock it in tests (it's easier to mock this class than ApiV2 directly)\nexport default class ApiClient {\n  constructor(private api: ApiV2) {}\n\n  public async getAllCredentialsApi(accountName: string): Promise<AllCredentialsApiResponse> {\n    return await this.api.getAsync('credentials/ios', { owner: accountName });\n  }\n  public async getAllCredentialsForAppApi({\n    accountName,\n    projectName,\n    bundleIdentifier,\n  }: AppLookupParams): Promise<IosAllCredentialsForApp> {\n    return await this.api.getAsync(\n      `credentials/ios/@${accountName}/${projectName}/${bundleIdentifier}`\n    );\n  }\n\n  public async getUserCredentialsByIdApi(\n    id: number,\n    accountName: string\n  ): Promise<IosDistCredentials | IosPushCredentials> {\n    return await this.api.getAsync(`credentials/ios/userCredentials/${id}`, { owner: accountName });\n  }\n\n  public async createDistCertApi(\n    accountName: string,\n    credentials: appleApi.DistCert\n  ): Promise<number> {\n    const { id } = await this.api.postAsync('credentials/ios/dist', {\n      owner: accountName,\n      credentials,\n    });\n    return id;\n  }\n\n  public async updateDistCertApi(\n    id: number,\n    accountName: string,\n    credentials: appleApi.DistCert\n  ): Promise<void> {\n    await this.api.putAsync(`credentials/ios/dist/${id}`, { credentials, owner: accountName });\n  }\n\n  public async deleteDistCertApi(id: number, accountName: string): Promise<void> {\n    await this.api.deleteAsync(`credentials/ios/dist/${id}`, { owner: accountName });\n  }\n\n  public async useDistCertApi(\n    { accountName, projectName, bundleIdentifier }: AppLookupParams,\n    userCredentialsId: number\n  ): Promise<void> {\n    await this.api.postAsync('credentials/ios/use/dist', {\n      experienceName: `@${accountName}/${projectName}`,\n      owner: accountName,\n      bundleIdentifier,\n      userCredentialsId,\n    });\n  }\n\n  public async createPushKeyApi(\n    accountName: string,\n    credentials: appleApi.PushKey\n  ): Promise<number> {\n    const { id } = await this.api.postAsync('credentials/ios/push', {\n      owner: accountName,\n      credentials,\n    });\n    return id;\n  }\n\n  public async updatePushKeyApi(\n    id: number,\n    accountName: string,\n    credentials: appleApi.PushKey\n  ): Promise<IosPushCredentials> {\n    return await this.api.putAsync(`credentials/ios/push/${id}`, { owner: accountName });\n  }\n\n  public async deletePushKeyApi(id: number, accountName: string): Promise<void> {\n    await this.api.deleteAsync(`credentials/ios/push/${id}`, { owner: accountName });\n  }\n\n  public async usePushKeyApi(\n    { accountName, projectName, bundleIdentifier }: AppLookupParams,\n    userCredentialsId: number\n  ): Promise<void> {\n    await this.api.postAsync('credentials/ios/use/push', {\n      experienceName: `@${accountName}/${projectName}`,\n      owner: accountName,\n      bundleIdentifier,\n      userCredentialsId,\n    });\n  }\n\n  public async deletePushCertApi({\n    accountName,\n    projectName,\n    bundleIdentifier,\n  }: AppLookupParams): Promise<void> {\n    await this.api.postAsync(`credentials/ios/pushCert/delete`, {\n      experienceName: `@${accountName}/${projectName}`,\n      owner: accountName,\n      bundleIdentifier,\n    });\n  }\n\n  public async updateProvisioningProfileApi(\n    { accountName, projectName, bundleIdentifier }: AppLookupParams,\n    credentials: appleApi.ProvisioningProfile\n  ): Promise<void> {\n    await this.api.postAsync(`credentials/ios/provisioningProfile/update`, {\n      experienceName: `@${accountName}/${projectName}`,\n      owner: accountName,\n      bundleIdentifier,\n      credentials,\n    });\n  }\n\n  public async deleteProvisioningProfileApi({\n    accountName,\n    projectName,\n    bundleIdentifier,\n  }: AppLookupParams): Promise<void> {\n    await this.api.postAsync(`credentials/ios/provisioningProfile/delete`, {\n      experienceName: `@${accountName}/${projectName}`,\n      owner: accountName,\n      bundleIdentifier,\n    });\n  }\n}\n"],"file":"IosApiV2Wrapper.js"}