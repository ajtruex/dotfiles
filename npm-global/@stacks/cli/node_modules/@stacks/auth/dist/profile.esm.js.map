{"version":3,"file":"profile.esm.js","sources":["../src/profile.ts"],"sourcesContent":["import { resolveZoneFileToProfile } from '@stacks/profile';\nimport { fetchPrivate } from '@stacks/common';\nimport { StacksNetwork, StacksMainnet } from '@stacks/network';\n\nexport interface ProfileLookupOptions {\n  username: string;\n  zoneFileLookupURL?: string;\n  network?: StacksNetwork;\n}\n\n/**\n * Look up a user profile by blockstack ID\n *\n * @param {string} username - The Blockstack ID of the profile to look up\n * @param {string} [zoneFileLookupURL=null] - The URL\n * to use for zonefile lookup. If falsey, lookupProfile will use the\n * blockstack.js [[getNameInfo]] function.\n * @returns {Promise} that resolves to a profile object\n */\nexport function lookupProfile(options: ProfileLookupOptions): Promise<Record<string, any>> {\n  if (!options.username) {\n    return Promise.reject();\n  }\n  let network: StacksNetwork = options.network ? options.network : new StacksMainnet();\n  let lookupPromise;\n  if (options.zoneFileLookupURL) {\n    const url = `${options.zoneFileLookupURL.replace(/\\/$/, '')}/${options.username}`;\n    lookupPromise = fetchPrivate(url).then(response => response.json());\n  } else {\n    lookupPromise = network.getNameInfo(options.username);\n  }\n  return lookupPromise.then((responseJSON: any) => {\n    if (responseJSON.hasOwnProperty('zonefile') && responseJSON.hasOwnProperty('address')) {\n      return resolveZoneFileToProfile(responseJSON.zonefile, responseJSON.address);\n    } else {\n      throw new Error(\n        'Invalid zonefile lookup response: did not contain `address`' + ' or `zonefile` field'\n      );\n    }\n  });\n}\n"],"names":["lookupProfile","options","username","Promise","reject","network","StacksMainnet","lookupPromise","zoneFileLookupURL","url","replace","fetchPrivate","then","response","json","getNameInfo","responseJSON","hasOwnProperty","resolveZoneFileToProfile","zonefile","address","Error"],"mappings":";;;;SAmBgBA,cAAcC;AAC5B,MAAI,CAACA,OAAO,CAACC,QAAb,EAAuB;AACrB,WAAOC,OAAO,CAACC,MAAR,EAAP;AACD;;AACD,MAAIC,OAAO,GAAkBJ,OAAO,CAACI,OAAR,GAAkBJ,OAAO,CAACI,OAA1B,GAAoC,IAAIC,aAAJ,EAAjE;AACA,MAAIC,aAAJ;;AACA,MAAIN,OAAO,CAACO,iBAAZ,EAA+B;AAC7B,QAAMC,GAAG,GAAMR,OAAO,CAACO,iBAAR,CAA0BE,OAA1B,CAAkC,KAAlC,EAAyC,EAAzC,CAAN,SAAsDT,OAAO,CAACC,QAAvE;AACAK,IAAAA,aAAa,GAAGI,YAAY,CAACF,GAAD,CAAZ,CAAkBG,IAAlB,CAAuB,UAAAC,QAAQ;AAAA,aAAIA,QAAQ,CAACC,IAAT,EAAJ;AAAA,KAA/B,CAAhB;AACD,GAHD,MAGO;AACLP,IAAAA,aAAa,GAAGF,OAAO,CAACU,WAAR,CAAoBd,OAAO,CAACC,QAA5B,CAAhB;AACD;;AACD,SAAOK,aAAa,CAACK,IAAd,CAAmB,UAACI,YAAD;AACxB,QAAIA,YAAY,CAACC,cAAb,CAA4B,UAA5B,KAA2CD,YAAY,CAACC,cAAb,CAA4B,SAA5B,CAA/C,EAAuF;AACrF,aAAOC,wBAAwB,CAACF,YAAY,CAACG,QAAd,EAAwBH,YAAY,CAACI,OAArC,CAA/B;AACD,KAFD,MAEO;AACL,YAAM,IAAIC,KAAJ,CACJ,gEAAgE,sBAD5D,CAAN;AAGD;AACF,GARM,CAAP;AASD;;;;"}