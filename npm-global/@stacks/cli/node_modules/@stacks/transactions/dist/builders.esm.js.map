{"version":3,"file":"builders.esm.js","sources":["../src/builders.ts"],"sourcesContent":["import { StacksTransaction } from './transaction';\n\nimport { StacksNetwork, StacksMainnet, StacksTestnet } from '@stacks/network';\n\nimport {\n  createTokenTransferPayload,\n  createSmartContractPayload,\n  createContractCallPayload,\n} from './payload';\n\nimport {\n  StandardAuthorization,\n  SponsoredAuthorization,\n  createSingleSigSpendingCondition,\n  createMultiSigSpendingCondition,\n} from './authorization';\n\nimport {\n  publicKeyToString,\n  createStacksPrivateKey,\n  getPublicKey,\n  publicKeyToAddress,\n  pubKeyfromPrivKey,\n  publicKeyFromBuffer,\n} from './keys';\n\nimport { TransactionSigner } from './signer';\n\nimport {\n  PostCondition,\n  STXPostCondition,\n  FungiblePostCondition,\n  NonFungiblePostCondition,\n  createSTXPostCondition,\n  createFungiblePostCondition,\n  createNonFungiblePostCondition,\n} from './postcondition';\n\nimport {\n  AddressHashMode,\n  AddressVersion,\n  FungibleConditionCode,\n  NonFungibleConditionCode,\n  PostConditionMode,\n  PayloadType,\n  AnchorMode,\n  TransactionVersion,\n  TxRejectedReason,\n  SingleSigHashMode,\n} from './constants';\n\nimport { AssetInfo, createLPList, createStandardPrincipal, createContractPrincipal } from './types';\n\nimport { cvToHex, parseReadOnlyResponse, omit } from './utils';\n\nimport { fetchPrivate } from '@stacks/common';\n\nimport BigNum from 'bn.js';\nimport { ClarityValue, PrincipalCV } from './clarity';\nimport { validateContractCall, ClarityAbi } from './contract-abi';\nimport { c32address } from 'c32check';\n\n/**\n * Lookup the nonce for an address from a core node\n *\n * @param {string} address - the c32check address to look up\n * @param {StacksNetwork} network - the Stacks network to look up address on\n *\n * @return a promise that resolves to an integer\n */\nexport async function getNonce(address: string, network?: StacksNetwork): Promise<BigNum> {\n  const defaultNetwork = new StacksMainnet();\n  const url = network\n    ? network.getAccountApiUrl(address)\n    : defaultNetwork.getAccountApiUrl(address);\n\n  const response = await fetchPrivate(url);\n  if (!response.ok) {\n    let msg = '';\n    try {\n      msg = await response.text();\n    } catch (error) {}\n    throw new Error(\n      `Error fetching nonce. Response ${response.status}: ${response.statusText}. Attempted to fetch ${url} and failed with the message: \"${msg}\"`\n    );\n  }\n  const result = (await response.json()) as { nonce: string };\n  return new BigNum(result.nonce);\n}\n\n/**\n * Estimate the total transaction fee in microstacks for a token transfer\n *\n * @param {StacksTransaction} transaction - the token transfer transaction to estimate fees for\n * @param {StacksNetwork} network - the Stacks network to estimate transaction for\n *\n * @return a promise that resolves to number of microstacks per byte\n */\nexport async function estimateTransfer(\n  transaction: StacksTransaction,\n  network?: StacksNetwork\n): Promise<BigNum> {\n  if (transaction.payload.payloadType !== PayloadType.TokenTransfer) {\n    throw new Error(\n      `Transaction fee estimation only possible with ${\n        PayloadType[PayloadType.TokenTransfer]\n      } transactions. Invoked with: ${PayloadType[transaction.payload.payloadType]}`\n    );\n  }\n\n  const requestHeaders = {\n    Accept: 'application/text',\n  };\n\n  const fetchOptions = {\n    method: 'GET',\n    headers: requestHeaders,\n  };\n\n  const defaultNetwork = new StacksMainnet();\n  const url = network\n    ? network.getTransferFeeEstimateApiUrl()\n    : defaultNetwork.getTransferFeeEstimateApiUrl();\n\n  const response = await fetchPrivate(url, fetchOptions);\n  if (!response.ok) {\n    let msg = '';\n    try {\n      msg = await response.text();\n    } catch (error) {}\n    throw new Error(\n      `Error estimating transaction fee. Response ${response.status}: ${response.statusText}. Attempted to fetch ${url} and failed with the message: \"${msg}\"`\n    );\n  }\n  const feeRateResult = await response.text();\n  const txBytes = new BigNum(transaction.serialize().byteLength);\n  const feeRate = new BigNum(feeRateResult);\n  return feeRate.mul(txBytes);\n}\n\nexport type TxBroadcastResultOk = string;\nexport type TxBroadcastResultRejected = {\n  error: string;\n  reason: TxRejectedReason;\n  reason_data: any;\n  txid: string;\n};\nexport type TxBroadcastResult = TxBroadcastResultOk | TxBroadcastResultRejected;\n\n/**\n * Broadcast the signed transaction to a core node\n *\n * @param {StacksTransaction} transaction - the token transfer transaction to broadcast\n * @param {StacksNetwork} network - the Stacks network to broadcast transaction to\n *\n * @returns {Promise} that resolves to a response if the operation succeeds\n */\nexport async function broadcastTransaction(\n  transaction: StacksTransaction,\n  network: StacksNetwork\n): Promise<TxBroadcastResult> {\n  const rawTx = transaction.serialize();\n  const url = network.getBroadcastApiUrl();\n\n  return broadcastRawTransaction(rawTx, url);\n}\n\n/**\n * Broadcast the signed transaction to a core node\n *\n * @param {Buffer} rawTx - the raw serialized transaction buffer to broadcast\n * @param {string} url - the broadcast endpoint URL\n *\n * @returns {Promise} that resolves to a response if the operation succeeds\n */\nexport async function broadcastRawTransaction(\n  rawTx: Buffer,\n  url: string\n): Promise<TxBroadcastResult> {\n  const requestHeaders = {\n    'Content-Type': 'application/octet-stream',\n  };\n\n  const options = {\n    method: 'POST',\n    headers: requestHeaders,\n    body: rawTx,\n  };\n\n  const response = await fetchPrivate(url, options);\n  if (!response.ok) {\n    try {\n      return (await response.json()) as TxBroadcastResult;\n    } catch (e) {\n      throw Error(`Failed to broadcast transaction: ${(e as Error).message}`);\n    }\n  }\n\n  const text = await response.text();\n  try {\n    return JSON.parse(text) as TxBroadcastResult;\n  } catch (e) {\n    return text;\n  }\n}\n\n/**\n * Fetch a contract's ABI\n *\n * @param {string} address - the contracts address\n * @param {string} contractName - the contracts name\n * @param {StacksNetwork} network - the Stacks network to broadcast transaction to\n *\n * @returns {Promise} that resolves to a ClarityAbi if the operation succeeds\n */\nexport async function getAbi(\n  address: string,\n  contractName: string,\n  network: StacksNetwork\n): Promise<ClarityAbi> {\n  const options = {\n    method: 'GET',\n  };\n\n  const url = network.getAbiApiUrl(address, contractName);\n\n  const response = await fetchPrivate(url, options);\n  if (!response.ok) {\n    let msg = '';\n    try {\n      msg = await response.text();\n    } catch (error) {}\n    throw new Error(\n      `Error fetching contract ABI for contract \"${contractName}\" at address ${address}. Response ${response.status}: ${response.statusText}. Attempted to fetch ${url} and failed with the message: \"${msg}\"`\n    );\n  }\n\n  return JSON.parse(await response.text()) as ClarityAbi;\n}\n\nexport interface MultiSigOptions {\n  numSignatures: number;\n  publicKeys: string[];\n  signerKeys?: string[];\n}\n\n/**\n * STX token transfer transaction options\n *\n * @param  {String|PrincipalCV} recipientAddress - the c32check address of the recipient or a\n *                                                  principal clarity value\n * @param  {BigNum} amount - number of tokens to transfer in microstacks\n * @param  {BigNum} fee - transaction fee in microstacks\n * @param  {BigNum} nonce - a nonce must be increased monotonically with each new transaction\n * @param  {StacksNetwork} network - the Stacks blockchain network this transaction is destined for\n * @param  {anchorMode} anchorMode - identify how the the transaction should be mined\n * @param  {String} memo - an arbitrary string to include with the transaction, must be less than\n *                          34 bytes\n * @param  {PostConditionMode} postConditionMode - whether post conditions must fully cover all\n *                                                 transferred assets\n * @param  {PostCondition[]} postConditions - an array of post conditions to add to the\n *                                                  transaction\n * @param  {Boolean} sponsored - true if another account is sponsoring the transaction fees\n */\nexport interface TokenTransferOptions {\n  recipient: string | PrincipalCV;\n  amount: BigNum;\n  fee?: BigNum;\n  nonce?: BigNum;\n  network?: StacksNetwork;\n  anchorMode?: AnchorMode;\n  memo?: string;\n  postConditionMode?: PostConditionMode;\n  postConditions?: PostCondition[];\n  sponsored?: boolean;\n}\n\nexport interface UnsignedTokenTransferOptions extends TokenTransferOptions {\n  publicKey: string;\n}\n\nexport interface SignedTokenTransferOptions extends TokenTransferOptions {\n  senderKey: string;\n}\n\nexport interface UnsignedMultiSigTokenTransferOptions extends TokenTransferOptions {\n  numSignatures: number;\n  publicKeys: string[];\n}\n\nexport interface SignedMultiSigTokenTransferOptions extends TokenTransferOptions {\n  numSignatures: number;\n  publicKeys: string[];\n  signerKeys: string[];\n}\n\n/**\n * Generates an unsigned Stacks token transfer transaction\n *\n * Returns a Stacks token transfer transaction.\n *\n * @param  {UnsignedTokenTransferOptions | UnsignedMultiSigTokenTransferOptions} txOptions - an options object for the token transfer\n *\n * @return {Promis<StacksTransaction>}\n */\nexport async function makeUnsignedSTXTokenTransfer(\n  txOptions: UnsignedTokenTransferOptions | UnsignedMultiSigTokenTransferOptions\n): Promise<StacksTransaction> {\n  const defaultOptions = {\n    fee: new BigNum(0),\n    nonce: new BigNum(0),\n    network: new StacksMainnet(),\n    anchorMode: AnchorMode.Any,\n    postConditionMode: PostConditionMode.Deny,\n    memo: '',\n    sponsored: false,\n  };\n\n  const options = Object.assign(defaultOptions, txOptions);\n\n  const payload = createTokenTransferPayload(options.recipient, options.amount, options.memo);\n\n  let authorization = null;\n  let spendingCondition = null;\n\n  if ('publicKey' in options) {\n    // single-sig\n    spendingCondition = createSingleSigSpendingCondition(\n      AddressHashMode.SerializeP2PKH,\n      options.publicKey,\n      options.nonce,\n      options.fee\n    );\n  } else {\n    // multi-sig\n    spendingCondition = createMultiSigSpendingCondition(\n      AddressHashMode.SerializeP2SH,\n      options.numSignatures,\n      options.publicKeys,\n      options.nonce,\n      options.fee\n    );\n  }\n\n  if (options.sponsored) {\n    authorization = new SponsoredAuthorization(spendingCondition);\n  } else {\n    authorization = new StandardAuthorization(spendingCondition);\n  }\n\n  const postConditions: PostCondition[] = [];\n  if (options.postConditions && options.postConditions.length > 0) {\n    options.postConditions.forEach(postCondition => {\n      postConditions.push(postCondition);\n    });\n  }\n\n  const lpPostConditions = createLPList(postConditions);\n  const transaction = new StacksTransaction(\n    options.network.version,\n    authorization,\n    payload,\n    lpPostConditions,\n    options.postConditionMode,\n    defaultOptions.anchorMode,\n    options.network.chainId\n  );\n\n  if (!txOptions.fee) {\n    const txFee = await estimateTransfer(transaction, options.network);\n    transaction.setFee(txFee);\n  }\n\n  if (!txOptions.nonce) {\n    const addressVersion =\n      options.network.version === TransactionVersion.Mainnet\n        ? AddressVersion.MainnetSingleSig\n        : AddressVersion.TestnetSingleSig;\n    const senderAddress = c32address(addressVersion, transaction.auth.spendingCondition!.signer);\n    const txNonce = await getNonce(senderAddress, options.network);\n    transaction.setNonce(txNonce);\n  }\n\n  return transaction;\n}\n\n/**\n * Generates a signed Stacks token transfer transaction\n *\n * Returns a signed Stacks token transfer transaction.\n *\n * @param  {SignedTokenTransferOptions | SignedMultiSigTokenTransferOptions} txOptions - an options object for the token transfer\n *\n * @return {StacksTransaction}\n */\nexport async function makeSTXTokenTransfer(\n  txOptions: SignedTokenTransferOptions | SignedMultiSigTokenTransferOptions\n): Promise<StacksTransaction> {\n  if ('senderKey' in txOptions) {\n    const publicKey = publicKeyToString(getPublicKey(createStacksPrivateKey(txOptions.senderKey)));\n    const options = omit(txOptions, 'senderKey');\n    const transaction = await makeUnsignedSTXTokenTransfer({ publicKey, ...options });\n\n    const privKey = createStacksPrivateKey(txOptions.senderKey);\n    const signer = new TransactionSigner(transaction);\n    signer.signOrigin(privKey);\n\n    return transaction;\n  } else {\n    const options = omit(txOptions, 'signerKeys');\n    const transaction = await makeUnsignedSTXTokenTransfer(options);\n\n    const signer = new TransactionSigner(transaction);\n    let pubKeys = txOptions.publicKeys;\n    for (const key of txOptions.signerKeys) {\n      const pubKey = pubKeyfromPrivKey(key);\n      pubKeys = pubKeys.filter(pk => pk !== pubKey.data.toString('hex'));\n      signer.signOrigin(createStacksPrivateKey(key));\n    }\n\n    for (const key of pubKeys) {\n      signer.appendOrigin(publicKeyFromBuffer(Buffer.from(key, 'hex')));\n    }\n\n    return transaction;\n  }\n}\n\n/**\n * Contract deploy transaction options\n *\n * @param  {String} contractName - the contract name\n * @param  {String} codeBody - the code body string\n * @param  {String} senderKey - hex string sender private key used to sign transaction\n * @param  {BigNum} fee - transaction fee in microstacks\n * @param  {BigNum} nonce - a nonce must be increased monotonically with each new transaction\n * @param  {StacksNetwork} network - the Stacks blockchain network this transaction is destined for\n * @param  {anchorMode} anchorMode - identify how the the transaction should be mined\n * @param  {PostConditionMode} postConditionMode - whether post conditions must fully cover all\n *                                                 transferred assets\n * @param  {PostCondition[]} postConditions - an array of post conditions to add to the\n *                                                  transaction\n * @param  {Boolean} sponsored - true if another account is sponsoring the transaction fees\n */\nexport interface ContractDeployOptions {\n  contractName: string;\n  codeBody: string;\n  senderKey: string;\n  fee?: BigNum;\n  nonce?: BigNum;\n  network?: StacksNetwork;\n  anchorMode?: AnchorMode;\n  postConditionMode?: PostConditionMode;\n  postConditions?: PostCondition[];\n  sponsored?: boolean;\n}\n\n/**\n * Estimate the total transaction fee in microstacks for a contract deploy\n *\n * @param {StacksTransaction} transaction - the token transfer transaction to estimate fees for\n * @param {StacksNetwork} network - the Stacks network to estimate transaction for\n *\n * @return a promise that resolves to number of microstacks per byte\n */\nexport async function estimateContractDeploy(\n  transaction: StacksTransaction,\n  network?: StacksNetwork\n): Promise<BigNum> {\n  if (transaction.payload.payloadType !== PayloadType.SmartContract) {\n    throw new Error(\n      `Contract deploy fee estimation only possible with ${\n        PayloadType[PayloadType.SmartContract]\n      } transactions. Invoked with: ${PayloadType[transaction.payload.payloadType]}`\n    );\n  }\n\n  const requestHeaders = {\n    Accept: 'application/text',\n  };\n\n  const fetchOptions = {\n    method: 'GET',\n    headers: requestHeaders,\n  };\n\n  // Place holder estimate until contract deploy fee estimation is fully implemented on Stacks\n  // blockchain core\n  const defaultNetwork = new StacksMainnet();\n  const url = network\n    ? network.getTransferFeeEstimateApiUrl()\n    : defaultNetwork.getTransferFeeEstimateApiUrl();\n\n  const response = await fetchPrivate(url, fetchOptions);\n  if (!response.ok) {\n    let msg = '';\n    try {\n      msg = await response.text();\n    } catch (error) {}\n    throw new Error(\n      `Error estimating contract deploy fee. Response ${response.status}: ${response.statusText}. Attempted to fetch ${url} and failed with the message: \"${msg}\"`\n    );\n  }\n  const feeRateResult = await response.text();\n  const txBytes = new BigNum(transaction.serialize().byteLength);\n  const feeRate = new BigNum(feeRateResult);\n  return feeRate.mul(txBytes);\n}\n\n/**\n * Generates a Clarity smart contract deploy transaction\n *\n * @param  {ContractDeployOptions} txOptions - an options object for the contract deploy\n *\n * Returns a signed Stacks smart contract deploy transaction.\n *\n * @return {StacksTransaction}\n */\nexport async function makeContractDeploy(\n  txOptions: ContractDeployOptions\n): Promise<StacksTransaction> {\n  const defaultOptions = {\n    fee: new BigNum(0),\n    nonce: new BigNum(0),\n    network: new StacksMainnet(),\n    anchorMode: AnchorMode.Any,\n    postConditionMode: PostConditionMode.Deny,\n    sponsored: false,\n  };\n\n  const options = Object.assign(defaultOptions, txOptions);\n\n  const payload = createSmartContractPayload(options.contractName, options.codeBody);\n\n  const addressHashMode = AddressHashMode.SerializeP2PKH;\n  const privKey = createStacksPrivateKey(options.senderKey);\n  const pubKey = getPublicKey(privKey);\n\n  let authorization = null;\n\n  const spendingCondition = createSingleSigSpendingCondition(\n    addressHashMode,\n    publicKeyToString(pubKey),\n    options.nonce,\n    options.fee\n  );\n\n  if (options.sponsored) {\n    authorization = new SponsoredAuthorization(spendingCondition);\n  } else {\n    authorization = new StandardAuthorization(spendingCondition);\n  }\n\n  const postConditions: PostCondition[] = [];\n  if (options.postConditions && options.postConditions.length > 0) {\n    options.postConditions.forEach(postCondition => {\n      postConditions.push(postCondition);\n    });\n  }\n\n  const lpPostConditions = createLPList(postConditions);\n  const transaction = new StacksTransaction(\n    options.network.version,\n    authorization,\n    payload,\n    lpPostConditions,\n    options.postConditionMode,\n    options.anchorMode,\n    options.network.chainId\n  );\n\n  if (!txOptions.fee) {\n    const txFee = await estimateContractDeploy(transaction, options.network);\n    transaction.setFee(txFee);\n  }\n\n  if (!txOptions.nonce) {\n    const addressVersion =\n      options.network.version === TransactionVersion.Mainnet\n        ? AddressVersion.MainnetSingleSig\n        : AddressVersion.TestnetSingleSig;\n    const senderAddress = publicKeyToAddress(addressVersion, pubKey);\n    const txNonce = await getNonce(senderAddress, options.network);\n    transaction.setNonce(txNonce);\n  }\n\n  if (options.senderKey) {\n    const signer = new TransactionSigner(transaction);\n    signer.signOrigin(privKey);\n  }\n\n  return transaction;\n}\n\n/**\n * Contract function call transaction options\n * @param  {String} contractAddress - the c32check address of the contract\n * @param  {String} contractName - the contract name\n * @param  {String} functionName - name of the function to be called\n * @param  {[ClarityValue]} functionArgs - an array of Clarity values as arguments to the function call\n * @param  {String} senderKey - hex string sender private key used to sign transaction\n * @param  {BigNum} fee - transaction fee in microstacks\n * @param  {BigNum} nonce - a nonce must be increased monotonically with each new transaction\n * @param  {StacksNetwork} network - the Stacks blockchain network this transaction is destined for\n * @param  {anchorMode} anchorMode - identify how the the transaction should be mined\n * @param  {PostConditionMode} postConditionMode - whether post conditions must fully cover all\n *                                                 transferred assets\n * @param  {PostCondition[]} postConditions - an array of post conditions to add to the\n *                                                  transaction\n * @param  {Boolean} sponsored - true if another account is sponsoring the transaction fees\n */\nexport interface ContractCallOptions {\n  contractAddress: string;\n  contractName: string;\n  functionName: string;\n  functionArgs: ClarityValue[];\n  fee?: BigNum;\n  feeEstimateApiUrl?: string;\n  nonce?: BigNum;\n  network?: StacksNetwork;\n  anchorMode?: AnchorMode;\n  postConditionMode?: PostConditionMode;\n  postConditions?: PostCondition[];\n  validateWithAbi?: boolean | ClarityAbi;\n  sponsored?: boolean;\n}\n\nexport interface UnsignedContractCallOptions extends ContractCallOptions {\n  publicKey: string;\n}\n\nexport interface SignedContractCallOptions extends ContractCallOptions {\n  senderKey: string;\n}\n\nexport interface UnsignedMultiSigContractCallOptions extends ContractCallOptions {\n  numSignatures: number;\n  publicKeys: string[];\n}\n\nexport interface SignedMultiSigContractCallOptions extends ContractCallOptions {\n  numSignatures: number;\n  publicKeys: string[];\n  signerKeys: string[];\n}\n\n/**\n * Estimate the total transaction fee in microstacks for a contract function call\n *\n * @param {StacksTransaction} transaction - the token transfer transaction to estimate fees for\n * @param {StacksNetwork} network - the Stacks network to estimate transaction for\n *\n * @return a promise that resolves to number of microstacks per byte\n */\nexport async function estimateContractFunctionCall(\n  transaction: StacksTransaction,\n  network?: StacksNetwork\n): Promise<BigNum> {\n  if (transaction.payload.payloadType !== PayloadType.ContractCall) {\n    throw new Error(\n      `Contract call fee estimation only possible with ${\n        PayloadType[PayloadType.ContractCall]\n      } transactions. Invoked with: ${PayloadType[transaction.payload.payloadType]}`\n    );\n  }\n\n  const requestHeaders = {\n    Accept: 'application/text',\n  };\n\n  const fetchOptions = {\n    method: 'GET',\n    headers: requestHeaders,\n  };\n\n  // Place holder estimate until contract call fee estimation is fully implemented on Stacks\n  // blockchain core\n  const defaultNetwork = new StacksMainnet();\n  const url = network\n    ? network.getTransferFeeEstimateApiUrl()\n    : defaultNetwork.getTransferFeeEstimateApiUrl();\n\n  const response = await fetchPrivate(url, fetchOptions);\n  if (!response.ok) {\n    let msg = '';\n    try {\n      msg = await response.text();\n    } catch (error) {}\n    throw new Error(\n      `Error estimating contract call fee. Response ${response.status}: ${response.statusText}. Attempted to fetch ${url} and failed with the message: \"${msg}\"`\n    );\n  }\n  const feeRateResult = await response.text();\n  const txBytes = new BigNum(transaction.serialize().byteLength);\n  const feeRate = new BigNum(feeRateResult);\n  return feeRate.mul(txBytes);\n}\n\n/**\n * Generates an unsigned Clarity smart contract function call transaction\n *\n * @param {UnsignedContractCallOptions | UnsignedMultiSigContractCallOptions} txOptions - an options object for the contract call\n *\n * @returns {Promise<StacksTransaction>}\n */\nexport async function makeUnsignedContractCall(\n  txOptions: UnsignedContractCallOptions | UnsignedMultiSigContractCallOptions\n): Promise<StacksTransaction> {\n  const defaultOptions = {\n    fee: new BigNum(0),\n    nonce: new BigNum(0),\n    network: new StacksMainnet(),\n    anchorMode: AnchorMode.Any,\n    postConditionMode: PostConditionMode.Deny,\n    sponsored: false,\n  };\n\n  const options = Object.assign(defaultOptions, txOptions);\n\n  const payload = createContractCallPayload(\n    options.contractAddress,\n    options.contractName,\n    options.functionName,\n    options.functionArgs\n  );\n\n  if (options?.validateWithAbi) {\n    let abi: ClarityAbi;\n    if (typeof options.validateWithAbi === 'boolean') {\n      if (options?.network) {\n        abi = await getAbi(options.contractAddress, options.contractName, options.network);\n      } else {\n        throw new Error('Network option must be provided in order to validate with ABI');\n      }\n    } else {\n      abi = options.validateWithAbi;\n    }\n\n    validateContractCall(payload, abi);\n  }\n\n  let spendingCondition = null;\n  let authorization = null;\n\n  if ('publicKey' in options) {\n    // single-sig\n    spendingCondition = createSingleSigSpendingCondition(\n      AddressHashMode.SerializeP2PKH,\n      options.publicKey,\n      options.nonce,\n      options.fee\n    );\n  } else {\n    // multi-sig\n    spendingCondition = createMultiSigSpendingCondition(\n      AddressHashMode.SerializeP2SH,\n      options.numSignatures,\n      options.publicKeys,\n      options.nonce,\n      options.fee\n    );\n  }\n\n  if (options.sponsored) {\n    authorization = new SponsoredAuthorization(spendingCondition);\n  } else {\n    authorization = new StandardAuthorization(spendingCondition);\n  }\n\n  const postConditions: PostCondition[] = [];\n  if (options.postConditions && options.postConditions.length > 0) {\n    options.postConditions.forEach(postCondition => {\n      postConditions.push(postCondition);\n    });\n  }\n\n  const lpPostConditions = createLPList(postConditions);\n  const transaction = new StacksTransaction(\n    options.network.version,\n    authorization,\n    payload,\n    lpPostConditions,\n    options.postConditionMode,\n    options.anchorMode,\n    options.network.chainId\n  );\n\n  if (!txOptions.fee) {\n    const txFee = await estimateContractFunctionCall(transaction, options.network);\n    transaction.setFee(txFee);\n  }\n\n  if (!txOptions.nonce) {\n    const addressVersion =\n      options.network.version === TransactionVersion.Mainnet\n        ? AddressVersion.MainnetSingleSig\n        : AddressVersion.TestnetSingleSig;\n    const senderAddress = c32address(addressVersion, transaction.auth.spendingCondition!.signer);\n    const txNonce = await getNonce(senderAddress, options.network);\n    transaction.setNonce(txNonce);\n  }\n\n  return transaction;\n}\n\n/**\n * Generates a Clarity smart contract function call transaction\n *\n * @param  {SignedContractCallOptions | SignedMultiSigContractCallOptions} txOptions - an options object for the contract function call\n *\n * Returns a signed Stacks smart contract function call transaction.\n *\n * @return {StacksTransaction}\n */\nexport async function makeContractCall(\n  txOptions: SignedContractCallOptions | SignedMultiSigContractCallOptions\n): Promise<StacksTransaction> {\n  if ('senderKey' in txOptions) {\n    const publicKey = publicKeyToString(getPublicKey(createStacksPrivateKey(txOptions.senderKey)));\n    const options = omit(txOptions, 'senderKey');\n    const transaction = await makeUnsignedContractCall({ publicKey, ...options });\n\n    const privKey = createStacksPrivateKey(txOptions.senderKey);\n    const signer = new TransactionSigner(transaction);\n    signer.signOrigin(privKey);\n\n    return transaction;\n  } else {\n    const options = omit(txOptions, 'signerKeys');\n    const transaction = await makeUnsignedContractCall(options);\n\n    const signer = new TransactionSigner(transaction);\n    let pubKeys = txOptions.publicKeys;\n    for (const key of txOptions.signerKeys) {\n      const pubKey = pubKeyfromPrivKey(key);\n      pubKeys = pubKeys.filter(pk => pk !== pubKey.data.toString('hex'));\n      signer.signOrigin(createStacksPrivateKey(key));\n    }\n\n    for (const key of pubKeys) {\n      signer.appendOrigin(publicKeyFromBuffer(Buffer.from(key, 'hex')));\n    }\n\n    return transaction;\n  }\n}\n\n/**\n * Generates a STX post condition with a standard principal\n *\n * Returns a STX post condition object\n *\n * @param  {String} address - the c32check address\n * @param  {FungibleConditionCode} conditionCode - the condition code\n * @param  {BigNum} amount - the amount of STX tokens\n *\n * @return {STXPostCondition}\n */\nexport function makeStandardSTXPostCondition(\n  address: string,\n  conditionCode: FungibleConditionCode,\n  amount: BigNum\n): STXPostCondition {\n  return createSTXPostCondition(createStandardPrincipal(address), conditionCode, amount);\n}\n\n/**\n * Generates a STX post condition with a contract principal\n *\n * Returns a STX post condition object\n *\n * @param  {String} address - the c32check address of the contract\n * @param  {String} contractName - the name of the contract\n * @param  {FungibleConditionCode} conditionCode - the condition code\n * @param  {BigNum} amount - the amount of STX tokens\n *\n * @return {STXPostCondition}\n */\nexport function makeContractSTXPostCondition(\n  address: string,\n  contractName: string,\n  conditionCode: FungibleConditionCode,\n  amount: BigNum\n): STXPostCondition {\n  return createSTXPostCondition(\n    createContractPrincipal(address, contractName),\n    conditionCode,\n    amount\n  );\n}\n\n/**\n * Generates a fungible token post condition with a standard principal\n *\n * Returns a fungible token post condition object\n *\n * @param  {String} address - the c32check address\n * @param  {FungibleConditionCode} conditionCode - the condition code\n * @param  {BigNum} amount - the amount of fungible tokens\n * @param  {AssetInfo} assetInfo - asset info describing the fungible token\n *\n * @return {FungiblePostCondition}\n */\nexport function makeStandardFungiblePostCondition(\n  address: string,\n  conditionCode: FungibleConditionCode,\n  amount: BigNum,\n  assetInfo: string | AssetInfo\n): FungiblePostCondition {\n  return createFungiblePostCondition(\n    createStandardPrincipal(address),\n    conditionCode,\n    amount,\n    assetInfo\n  );\n}\n\n/**\n * Generates a fungible token post condition with a contract principal\n *\n * Returns a fungible token post condition object\n *\n * @param  {String} address - the c32check address\n * @param  {String} contractName - the name of the contract\n * @param  {FungibleConditionCode} conditionCode - the condition code\n * @param  {BigNum} amount - the amount of fungible tokens\n * @param  {AssetInfo} assetInfo - asset info describing the fungible token\n *\n * @return {FungiblePostCondition}\n */\nexport function makeContractFungiblePostCondition(\n  address: string,\n  contractName: string,\n  conditionCode: FungibleConditionCode,\n  amount: BigNum,\n  assetInfo: string | AssetInfo\n): FungiblePostCondition {\n  return createFungiblePostCondition(\n    createContractPrincipal(address, contractName),\n    conditionCode,\n    amount,\n    assetInfo\n  );\n}\n\n/**\n * Generates a non-fungible token post condition with a standard principal\n *\n * Returns a non-fungible token post condition object\n *\n * @param  {String} address - the c32check address\n * @param  {FungibleConditionCode} conditionCode - the condition code\n * @param  {AssetInfo} assetInfo - asset info describing the non-fungible token\n * @param  {ClarityValue} assetName - asset name describing the non-fungible token\n *\n * @return {NonFungiblePostCondition}\n */\nexport function makeStandardNonFungiblePostCondition(\n  address: string,\n  conditionCode: NonFungibleConditionCode,\n  assetInfo: string | AssetInfo,\n  assetName: ClarityValue\n): NonFungiblePostCondition {\n  return createNonFungiblePostCondition(\n    createStandardPrincipal(address),\n    conditionCode,\n    assetInfo,\n    assetName\n  );\n}\n\n/**\n * Generates a non-fungible token post condition with a contract principal\n *\n * Returns a non-fungible token post condition object\n *\n * @param  {String} address - the c32check address\n * @param  {String} contractName - the name of the contract\n * @param  {FungibleConditionCode} conditionCode - the condition code\n * @param  {AssetInfo} assetInfo - asset info describing the non-fungible token\n * @param  {ClarityValue} assetName - asset name describing the non-fungible token\n *\n * @return {NonFungiblePostCondition}\n */\nexport function makeContractNonFungiblePostCondition(\n  address: string,\n  contractName: string,\n  conditionCode: NonFungibleConditionCode,\n  assetInfo: string | AssetInfo,\n  assetName: ClarityValue\n): NonFungiblePostCondition {\n  return createNonFungiblePostCondition(\n    createContractPrincipal(address, contractName),\n    conditionCode,\n    assetInfo,\n    assetName\n  );\n}\n\n/**\n * Read only function options\n *\n * @param  {String} contractAddress - the c32check address of the contract\n * @param  {String} contractName - the contract name\n * @param  {String} functionName - name of the function to be called\n * @param  {[ClarityValue]} functionArgs - an array of Clarity values as arguments to the function call\n * @param  {StacksNetwork} network - the Stacks blockchain network this transaction is destined for\n * @param  {String} senderAddress - the c32check address of the sender\n */\n\nexport interface ReadOnlyFunctionOptions {\n  contractName: string;\n  contractAddress: string;\n  functionName: string;\n  functionArgs: ClarityValue[];\n  network?: StacksNetwork;\n  senderAddress: string;\n}\n\n/**\n * Calls a read only function from a contract interface\n *\n * @param  {ReadOnlyFunctionOptions} readOnlyFunctionOptions - the options object\n *\n * Returns an object with a status bool (okay) and a result string that is a serialized clarity value in hex format.\n *\n * @return {ClarityValue}\n */\nexport async function callReadOnlyFunction(\n  readOnlyFunctionOptions: ReadOnlyFunctionOptions\n): Promise<ClarityValue> {\n  const defaultOptions = {\n    network: new StacksMainnet(),\n  };\n\n  const options = Object.assign(defaultOptions, readOnlyFunctionOptions);\n\n  const {\n    contractName,\n    contractAddress,\n    functionName,\n    functionArgs,\n    network,\n    senderAddress,\n  } = options;\n\n  const url = network.getReadOnlyFunctionCallApiUrl(contractAddress, contractName, functionName);\n\n  const args = functionArgs.map(arg => cvToHex(arg));\n\n  const body = JSON.stringify({\n    sender: senderAddress,\n    arguments: args,\n  });\n\n  const response = await fetchPrivate(url, {\n    method: 'POST',\n    body,\n    headers: {\n      'Content-Type': 'application/json',\n    },\n  });\n\n  if (!response.ok) {\n    let msg = '';\n    try {\n      msg = await response.text();\n    } catch (error) {}\n    throw new Error(\n      `Error calling read-only function. Response ${response.status}: ${response.statusText}. Attempted to fetch ${url} and failed with the message: \"${msg}\"`\n    );\n  }\n\n  return response.json().then(responseJson => parseReadOnlyResponse(responseJson));\n}\n\n/**\n * Sponsored transaction options\n *\n * @param  {StacksTransaction} transaction - the origin-signed transaction to sponsor\n * @param  {String} sponsorPrivateKey - the sponsor's private key\n * @param  {BigNum} fee - the transaction fee amount to sponsor\n * @param  {BigNum} sponsorNonce - the nonce of the sponsor account\n * @param  {AddressHashMode} sponsorAddressHashmode - the sponsor address hashmode\n * @param  {StacksNetwork} network - the Stacks blockchain network this transaction is destined for\n */\nexport interface SponsorOptions {\n  transaction: StacksTransaction;\n  sponsorPrivateKey: string;\n  fee?: BigNum;\n  sponsorNonce?: BigNum;\n  sponsorAddressHashmode?: AddressHashMode;\n  network?: StacksNetwork;\n}\n\n/**\n * Constructs and signs a sponsored transaction as the sponsor\n *\n * @param  {SponsorOptions} sponsorOptions - the sponsor options object\n *\n * Returns a signed sponsored transaction.\n *\n * @return {ClarityValue}\n */\nexport async function sponsorTransaction(\n  sponsorOptions: SponsorOptions\n): Promise<StacksTransaction> {\n  const defaultOptions = {\n    fee: new BigNum(0),\n    sponsorNonce: new BigNum(0),\n    sponsorAddressHashmode: AddressHashMode.SerializeP2PKH as SingleSigHashMode,\n  };\n\n  const options = Object.assign(defaultOptions, sponsorOptions);\n  const network =\n    sponsorOptions.network ??\n    (options.transaction.version === TransactionVersion.Mainnet\n      ? new StacksMainnet()\n      : new StacksTestnet());\n  const sponsorPubKey = pubKeyfromPrivKey(options.sponsorPrivateKey);\n\n  if (!sponsorOptions.fee) {\n    let txFee = new BigNum(0);\n    switch (options.transaction.payload.payloadType) {\n      case PayloadType.TokenTransfer:\n        txFee = await estimateTransfer(options.transaction, network);\n        break;\n      case PayloadType.SmartContract:\n        txFee = await estimateContractDeploy(options.transaction, network);\n        break;\n      case PayloadType.ContractCall:\n        txFee = await estimateContractFunctionCall(options.transaction, network);\n        break;\n      default:\n        throw new Error(\n          `Spnsored transactions not supported for transaction type ${\n            PayloadType[options.transaction.payload.payloadType]\n          }`\n        );\n    }\n    options.transaction.setFee(txFee);\n    options.fee = txFee;\n  }\n\n  if (!sponsorOptions.sponsorNonce) {\n    const addressVersion =\n      network.version === TransactionVersion.Mainnet\n        ? AddressVersion.MainnetSingleSig\n        : AddressVersion.TestnetSingleSig;\n\n    const senderAddress = publicKeyToAddress(addressVersion, sponsorPubKey);\n    const sponsorNonce = await getNonce(senderAddress, network);\n    options.sponsorNonce = sponsorNonce;\n  }\n\n  const sponsorSpendingCondition = createSingleSigSpendingCondition(\n    options.sponsorAddressHashmode,\n    publicKeyToString(sponsorPubKey),\n    options.sponsorNonce,\n    options.fee\n  );\n\n  options.transaction.setSponsor(sponsorSpendingCondition);\n\n  const privKey = createStacksPrivateKey(options.sponsorPrivateKey);\n  const signer = TransactionSigner.createSponsorSigner(\n    options.transaction,\n    sponsorSpendingCondition\n  );\n  signer.signSponsor(privKey);\n\n  return options.transaction;\n}\n"],"names":["getNonce","address","network","defaultNetwork","StacksMainnet","url","getAccountApiUrl","fetchPrivate","response","ok","msg","text","Error","status","statusText","json","result","BigNum","nonce","estimateTransfer","transaction","payload","payloadType","PayloadType","TokenTransfer","requestHeaders","Accept","fetchOptions","method","headers","getTransferFeeEstimateApiUrl","feeRateResult","txBytes","serialize","byteLength","feeRate","mul","broadcastTransaction","rawTx","getBroadcastApiUrl","broadcastRawTransaction","options","body","message","JSON","parse","getAbi","contractName","getAbiApiUrl","makeUnsignedSTXTokenTransfer","txOptions","defaultOptions","fee","anchorMode","AnchorMode","Any","postConditionMode","PostConditionMode","Deny","memo","sponsored","Object","assign","createTokenTransferPayload","recipient","amount","authorization","spendingCondition","createSingleSigSpendingCondition","AddressHashMode","SerializeP2PKH","publicKey","createMultiSigSpendingCondition","SerializeP2SH","numSignatures","publicKeys","SponsoredAuthorization","StandardAuthorization","postConditions","length","forEach","postCondition","push","lpPostConditions","createLPList","StacksTransaction","version","chainId","txFee","setFee","addressVersion","TransactionVersion","Mainnet","AddressVersion","MainnetSingleSig","TestnetSingleSig","senderAddress","c32address","auth","signer","txNonce","setNonce","makeSTXTokenTransfer","publicKeyToString","getPublicKey","createStacksPrivateKey","senderKey","omit","privKey","TransactionSigner","signOrigin","pubKeys","key","pubKey","pubKeyfromPrivKey","filter","pk","data","toString","signerKeys","appendOrigin","publicKeyFromBuffer","Buffer","from","estimateContractDeploy","SmartContract","makeContractDeploy","createSmartContractPayload","codeBody","addressHashMode","publicKeyToAddress","estimateContractFunctionCall","ContractCall","makeUnsignedContractCall","createContractCallPayload","contractAddress","functionName","functionArgs","validateWithAbi","abi","validateContractCall","makeContractCall","makeStandardSTXPostCondition","conditionCode","createSTXPostCondition","createStandardPrincipal","makeContractSTXPostCondition","createContractPrincipal","makeStandardFungiblePostCondition","assetInfo","createFungiblePostCondition","makeContractFungiblePostCondition","makeStandardNonFungiblePostCondition","assetName","createNonFungiblePostCondition","makeContractNonFungiblePostCondition","callReadOnlyFunction","readOnlyFunctionOptions","getReadOnlyFunctionCallApiUrl","args","map","arg","cvToHex","stringify","sender","arguments","then","responseJson","parseReadOnlyResponse","sponsorTransaction","sponsorOptions","sponsorNonce","sponsorAddressHashmode","StacksTestnet","sponsorPubKey","sponsorPrivateKey","sponsorSpendingCondition","setSponsor","createSponsorSigner","signSponsor"],"mappings":"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"}